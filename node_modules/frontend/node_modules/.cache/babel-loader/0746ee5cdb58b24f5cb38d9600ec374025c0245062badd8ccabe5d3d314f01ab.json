{"ast":null,"code":"import axios from \"axios\";\n\n// Configuration des URLs de base pour chaque service\nexport const AUTH_API_URL = process.env.REACT_APP_AUTH_API_URL || \"http://localhost:3001/api\";\nexport const ADMIN_API_URL = process.env.REACT_APP_ADMIN_API_URL || \"http://localhost:3000\";\n\n// Instance axios pour le service d'authentification\nexport const authApi = axios.create({\n  baseURL: AUTH_API_URL\n});\n\n// Instance axios pour le service admin\nexport const adminApi = axios.create({\n  baseURL: ADMIN_API_URL\n});\n\n// Intercepteur pour ajouter le token à toutes les requêtes\nconst addAuthToken = config => {\n  const token = localStorage.getItem(\"token\");\n  if (token) {\n    config.headers.Authorization = `Bearer ${token}`;\n  }\n  return config;\n};\n\n// Appliquer l'intercepteur aux deux instances\nauthApi.interceptors.request.use(addAuthToken);\nadminApi.interceptors.request.use(addAuthToken);\n\n// Intercepteur pour gérer les erreurs d'authentification\nconst handleAuthError = error => {\n  var _error$response, _error$response2, _error$response3;\n  // Log l'erreur pour déboguer\n  console.error('API Error:', (_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.status, (_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : _error$response2.data);\n\n  // Ne pas rediriger vers login pour les erreurs admin API (pour le développement)\n  if (((_error$response3 = error.response) === null || _error$response3 === void 0 ? void 0 : _error$response3.status) === 401 && error.config.baseURL === AUTH_API_URL) {\n    localStorage.removeItem(\"token\");\n    localStorage.removeItem(\"user\");\n    window.location.href = \"/login\";\n  }\n  return Promise.reject(error);\n};\nauthApi.interceptors.response.use(response => response, handleAuthError);\nadminApi.interceptors.response.use(response => response, handleAuthError);\nexport default {\n  authApi,\n  adminApi\n};","map":{"version":3,"names":["axios","AUTH_API_URL","process","env","REACT_APP_AUTH_API_URL","ADMIN_API_URL","REACT_APP_ADMIN_API_URL","authApi","create","baseURL","adminApi","addAuthToken","config","token","localStorage","getItem","headers","Authorization","interceptors","request","use","handleAuthError","error","_error$response","_error$response2","_error$response3","console","response","status","data","removeItem","window","location","href","Promise","reject"],"sources":["C:/Users/zeine/Desktop/university-temp/frontend/front/src/config/api.js"],"sourcesContent":["import axios from \"axios\";\r\n\r\n// Configuration des URLs de base pour chaque service\r\nexport const AUTH_API_URL = process.env.REACT_APP_AUTH_API_URL || \"http://localhost:3001/api\";\r\nexport const ADMIN_API_URL = process.env.REACT_APP_ADMIN_API_URL || \"http://localhost:3000\";\r\n\r\n// Instance axios pour le service d'authentification\r\nexport const authApi = axios.create({\r\n  baseURL: AUTH_API_URL,\r\n});\r\n\r\n// Instance axios pour le service admin\r\nexport const adminApi = axios.create({\r\n  baseURL: ADMIN_API_URL,\r\n});\r\n\r\n// Intercepteur pour ajouter le token à toutes les requêtes\r\nconst addAuthToken = (config) => {\r\n  const token = localStorage.getItem(\"token\");\r\n  if (token) {\r\n    config.headers.Authorization = `Bearer ${token}`;\r\n  }\r\n  return config;\r\n};\r\n\r\n// Appliquer l'intercepteur aux deux instances\r\nauthApi.interceptors.request.use(addAuthToken);\r\nadminApi.interceptors.request.use(addAuthToken);\r\n\r\n// Intercepteur pour gérer les erreurs d'authentification\r\nconst handleAuthError = (error) => {\r\n  // Log l'erreur pour déboguer\r\n  console.error('API Error:', error.response?.status, error.response?.data);\r\n  \r\n  // Ne pas rediriger vers login pour les erreurs admin API (pour le développement)\r\n  if (error.response?.status === 401 && error.config.baseURL === AUTH_API_URL) {\r\n    localStorage.removeItem(\"token\");\r\n    localStorage.removeItem(\"user\");\r\n    window.location.href = \"/login\";\r\n  }\r\n  return Promise.reject(error);\r\n};\r\n\r\nauthApi.interceptors.response.use((response) => response, handleAuthError);\r\nadminApi.interceptors.response.use((response) => response, handleAuthError);\r\n\r\nexport default { authApi, adminApi };\r\n"],"mappings":"AAAA,OAAOA,KAAK,MAAM,OAAO;;AAEzB;AACA,OAAO,MAAMC,YAAY,GAAGC,OAAO,CAACC,GAAG,CAACC,sBAAsB,IAAI,2BAA2B;AAC7F,OAAO,MAAMC,aAAa,GAAGH,OAAO,CAACC,GAAG,CAACG,uBAAuB,IAAI,uBAAuB;;AAE3F;AACA,OAAO,MAAMC,OAAO,GAAGP,KAAK,CAACQ,MAAM,CAAC;EAClCC,OAAO,EAAER;AACX,CAAC,CAAC;;AAEF;AACA,OAAO,MAAMS,QAAQ,GAAGV,KAAK,CAACQ,MAAM,CAAC;EACnCC,OAAO,EAAEJ;AACX,CAAC,CAAC;;AAEF;AACA,MAAMM,YAAY,GAAIC,MAAM,IAAK;EAC/B,MAAMC,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;EAC3C,IAAIF,KAAK,EAAE;IACTD,MAAM,CAACI,OAAO,CAACC,aAAa,GAAG,UAAUJ,KAAK,EAAE;EAClD;EACA,OAAOD,MAAM;AACf,CAAC;;AAED;AACAL,OAAO,CAACW,YAAY,CAACC,OAAO,CAACC,GAAG,CAACT,YAAY,CAAC;AAC9CD,QAAQ,CAACQ,YAAY,CAACC,OAAO,CAACC,GAAG,CAACT,YAAY,CAAC;;AAE/C;AACA,MAAMU,eAAe,GAAIC,KAAK,IAAK;EAAA,IAAAC,eAAA,EAAAC,gBAAA,EAAAC,gBAAA;EACjC;EACAC,OAAO,CAACJ,KAAK,CAAC,YAAY,GAAAC,eAAA,GAAED,KAAK,CAACK,QAAQ,cAAAJ,eAAA,uBAAdA,eAAA,CAAgBK,MAAM,GAAAJ,gBAAA,GAAEF,KAAK,CAACK,QAAQ,cAAAH,gBAAA,uBAAdA,gBAAA,CAAgBK,IAAI,CAAC;;EAEzE;EACA,IAAI,EAAAJ,gBAAA,GAAAH,KAAK,CAACK,QAAQ,cAAAF,gBAAA,uBAAdA,gBAAA,CAAgBG,MAAM,MAAK,GAAG,IAAIN,KAAK,CAACV,MAAM,CAACH,OAAO,KAAKR,YAAY,EAAE;IAC3Ea,YAAY,CAACgB,UAAU,CAAC,OAAO,CAAC;IAChChB,YAAY,CAACgB,UAAU,CAAC,MAAM,CAAC;IAC/BC,MAAM,CAACC,QAAQ,CAACC,IAAI,GAAG,QAAQ;EACjC;EACA,OAAOC,OAAO,CAACC,MAAM,CAACb,KAAK,CAAC;AAC9B,CAAC;AAEDf,OAAO,CAACW,YAAY,CAACS,QAAQ,CAACP,GAAG,CAAEO,QAAQ,IAAKA,QAAQ,EAAEN,eAAe,CAAC;AAC1EX,QAAQ,CAACQ,YAAY,CAACS,QAAQ,CAACP,GAAG,CAAEO,QAAQ,IAAKA,QAAQ,EAAEN,eAAe,CAAC;AAE3E,eAAe;EAAEd,OAAO;EAAEG;AAAS,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}