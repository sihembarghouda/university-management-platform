{"ast":null,"code":"import { confirmPasswordReset, verifyPasswordResetCode, applyActionCode, checkActionCode, sendPasswordResetEmail } from 'firebase/auth';\nimport { auth } from '../config/firebase';\nimport axios from 'axios';\nconst AUTH_API_URL = process.env.REACT_APP_AUTH_API_URL || 'http://localhost:3001/api';\n\n/**\r\n * Service pour g√©rer l'authentification Firebase\r\n */\nconst firebaseAuthService = {\n  /**\r\n   * Demander un lien de r√©initialisation de mot de passe\r\n   * Utilise Firebase Authentication pour envoyer l'email directement\r\n   * PAS BESOIN du backend - Firebase g√®re tout !\r\n   */\n  async requestPasswordReset(email) {\n    try {\n      console.log('üî• [Firebase] Envoi email de r√©initialisation pour:', email);\n\n      // Firebase envoie l'email directement - aucun appel backend n√©cessaire!\n      await sendPasswordResetEmail(auth, email, {\n        url: `${window.location.origin}/reset-password`,\n        handleCodeInApp: false\n      });\n      console.log('‚úÖ [Firebase] Email de r√©initialisation envoy√© avec succ√®s!');\n      return {\n        success: true,\n        message: 'Un email de r√©initialisation a √©t√© envoy√© par Firebase'\n      };\n    } catch (error) {\n      console.error('‚ùå [Firebase] Erreur lors de l\\'envoi de l\\'email:', error);\n\n      // Si l'utilisateur n'existe pas dans Firebase, cr√©er le compte via le backend\n      if (error.code === 'auth/user-not-found') {\n        console.log('‚ö†Ô∏è Utilisateur pas encore dans Firebase, appel au backend...');\n        try {\n          const response = await axios.post(`${AUTH_API_URL}/auth/forgot-password`, {\n            email\n          });\n          return {\n            success: true,\n            message: response.data.message || 'Email de r√©initialisation envoy√©'\n          };\n        } catch (backendError) {\n          console.error('‚ùå Erreur backend aussi:', backendError);\n          throw backendError;\n        }\n      }\n      throw error;\n    }\n  },\n  /**\r\n   * V√©rifier si le code de r√©initialisation Firebase est valide\r\n   * @param {string} oobCode - Le code d'action Firebase (oobCode)\r\n   * @returns {Promise<string>} - L'email associ√© au code\r\n   */\n  async verifyPasswordResetCode(oobCode) {\n    try {\n      const email = await verifyPasswordResetCode(auth, oobCode);\n      console.log('‚úÖ Password reset code verified for:', email);\n      return email;\n    } catch (error) {\n      console.error('‚ùå Error verifying password reset code:', error);\n      throw error;\n    }\n  },\n  /**\r\n   * R√©initialiser le mot de passe avec Firebase\r\n   * @param {string} oobCode - Le code d'action Firebase\r\n   * @param {string} newPassword - Le nouveau mot de passe\r\n   */\n  async confirmPasswordReset(oobCode, newPassword) {\n    try {\n      await confirmPasswordReset(auth, oobCode, newPassword);\n      console.log('‚úÖ Password reset successful via Firebase');\n      return {\n        success: true,\n        message: 'Mot de passe r√©initialis√© avec succ√®s'\n      };\n    } catch (error) {\n      console.error('‚ùå Error confirming password reset:', error);\n      throw error;\n    }\n  },\n  /**\r\n   * R√©initialiser le mot de passe avec le backend (fallback si pas de Firebase)\r\n   * @param {string} email - Email de l'utilisateur\r\n   * @param {string} token - Token de r√©initialisation local\r\n   * @param {string} newPassword - Le nouveau mot de passe\r\n   */\n  async resetPasswordWithToken(email, token, newPassword) {\n    try {\n      const response = await axios.post(`${AUTH_API_URL}/auth/reset-password`, {\n        email,\n        token,\n        newPassword\n      });\n      return {\n        success: true,\n        message: response.data.message || 'Mot de passe r√©initialis√© avec succ√®s'\n      };\n    } catch (error) {\n      console.error('Error resetting password with token:', error);\n      throw error;\n    }\n  },\n  /**\r\n   * V√©rifier le type d'action Firebase (reset password, verify email, etc.)\r\n   * @param {string} oobCode - Le code d'action Firebase\r\n   */\n  async checkActionCode(oobCode) {\n    try {\n      const info = await checkActionCode(auth, oobCode);\n      console.log('‚úÖ Action code info:', info);\n      return info;\n    } catch (error) {\n      console.error('‚ùå Error checking action code:', error);\n      throw error;\n    }\n  },\n  /**\r\n   * Appliquer une action Firebase (par exemple, v√©rifier l'email)\r\n   * @param {string} oobCode - Le code d'action Firebase\r\n   */\n  async applyActionCode(oobCode) {\n    try {\n      await applyActionCode(auth, oobCode);\n      console.log('‚úÖ Action code applied successfully');\n      return {\n        success: true,\n        message: 'Action appliqu√©e avec succ√®s'\n      };\n    } catch (error) {\n      console.error('‚ùå Error applying action code:', error);\n      throw error;\n    }\n  }\n};\nexport default firebaseAuthService;","map":{"version":3,"names":["confirmPasswordReset","verifyPasswordResetCode","applyActionCode","checkActionCode","sendPasswordResetEmail","auth","axios","AUTH_API_URL","process","env","REACT_APP_AUTH_API_URL","firebaseAuthService","requestPasswordReset","email","console","log","url","window","location","origin","handleCodeInApp","success","message","error","code","response","post","data","backendError","oobCode","newPassword","resetPasswordWithToken","token","info"],"sources":["C:/Users/zeine/Desktop/university-temp/frontend/front/src/services/firebaseAuthService.js"],"sourcesContent":["import { \r\n  confirmPasswordReset, \r\n  verifyPasswordResetCode,\r\n  applyActionCode,\r\n  checkActionCode,\r\n  sendPasswordResetEmail\r\n} from 'firebase/auth';\r\nimport { auth } from '../config/firebase';\r\nimport axios from 'axios';\r\n\r\nconst AUTH_API_URL = process.env.REACT_APP_AUTH_API_URL || 'http://localhost:3001/api';\r\n\r\n/**\r\n * Service pour g√©rer l'authentification Firebase\r\n */\r\nconst firebaseAuthService = {\r\n  /**\r\n   * Demander un lien de r√©initialisation de mot de passe\r\n   * Utilise Firebase Authentication pour envoyer l'email directement\r\n   * PAS BESOIN du backend - Firebase g√®re tout !\r\n   */\r\n  async requestPasswordReset(email) {\r\n    try {\r\n      console.log('üî• [Firebase] Envoi email de r√©initialisation pour:', email);\r\n      \r\n      // Firebase envoie l'email directement - aucun appel backend n√©cessaire!\r\n      await sendPasswordResetEmail(auth, email, {\r\n        url: `${window.location.origin}/reset-password`,\r\n        handleCodeInApp: false\r\n      });\r\n      \r\n      console.log('‚úÖ [Firebase] Email de r√©initialisation envoy√© avec succ√®s!');\r\n      \r\n      return {\r\n        success: true,\r\n        message: 'Un email de r√©initialisation a √©t√© envoy√© par Firebase'\r\n      };\r\n    } catch (error) {\r\n      console.error('‚ùå [Firebase] Erreur lors de l\\'envoi de l\\'email:', error);\r\n      \r\n      // Si l'utilisateur n'existe pas dans Firebase, cr√©er le compte via le backend\r\n      if (error.code === 'auth/user-not-found') {\r\n        console.log('‚ö†Ô∏è Utilisateur pas encore dans Firebase, appel au backend...');\r\n        try {\r\n          const response = await axios.post(`${AUTH_API_URL}/auth/forgot-password`, { email });\r\n          return {\r\n            success: true,\r\n            message: response.data.message || 'Email de r√©initialisation envoy√©'\r\n          };\r\n        } catch (backendError) {\r\n          console.error('‚ùå Erreur backend aussi:', backendError);\r\n          throw backendError;\r\n        }\r\n      }\r\n      \r\n      throw error;\r\n    }\r\n  },\r\n\r\n  /**\r\n   * V√©rifier si le code de r√©initialisation Firebase est valide\r\n   * @param {string} oobCode - Le code d'action Firebase (oobCode)\r\n   * @returns {Promise<string>} - L'email associ√© au code\r\n   */\r\n  async verifyPasswordResetCode(oobCode) {\r\n    try {\r\n      const email = await verifyPasswordResetCode(auth, oobCode);\r\n      console.log('‚úÖ Password reset code verified for:', email);\r\n      return email;\r\n    } catch (error) {\r\n      console.error('‚ùå Error verifying password reset code:', error);\r\n      throw error;\r\n    }\r\n  },\r\n\r\n  /**\r\n   * R√©initialiser le mot de passe avec Firebase\r\n   * @param {string} oobCode - Le code d'action Firebase\r\n   * @param {string} newPassword - Le nouveau mot de passe\r\n   */\r\n  async confirmPasswordReset(oobCode, newPassword) {\r\n    try {\r\n      await confirmPasswordReset(auth, oobCode, newPassword);\r\n      console.log('‚úÖ Password reset successful via Firebase');\r\n      return {\r\n        success: true,\r\n        message: 'Mot de passe r√©initialis√© avec succ√®s'\r\n      };\r\n    } catch (error) {\r\n      console.error('‚ùå Error confirming password reset:', error);\r\n      throw error;\r\n    }\r\n  },\r\n\r\n  /**\r\n   * R√©initialiser le mot de passe avec le backend (fallback si pas de Firebase)\r\n   * @param {string} email - Email de l'utilisateur\r\n   * @param {string} token - Token de r√©initialisation local\r\n   * @param {string} newPassword - Le nouveau mot de passe\r\n   */\r\n  async resetPasswordWithToken(email, token, newPassword) {\r\n    try {\r\n      const response = await axios.post(`${AUTH_API_URL}/auth/reset-password`, {\r\n        email,\r\n        token,\r\n        newPassword\r\n      });\r\n      return {\r\n        success: true,\r\n        message: response.data.message || 'Mot de passe r√©initialis√© avec succ√®s'\r\n      };\r\n    } catch (error) {\r\n      console.error('Error resetting password with token:', error);\r\n      throw error;\r\n    }\r\n  },\r\n\r\n  /**\r\n   * V√©rifier le type d'action Firebase (reset password, verify email, etc.)\r\n   * @param {string} oobCode - Le code d'action Firebase\r\n   */\r\n  async checkActionCode(oobCode) {\r\n    try {\r\n      const info = await checkActionCode(auth, oobCode);\r\n      console.log('‚úÖ Action code info:', info);\r\n      return info;\r\n    } catch (error) {\r\n      console.error('‚ùå Error checking action code:', error);\r\n      throw error;\r\n    }\r\n  },\r\n\r\n  /**\r\n   * Appliquer une action Firebase (par exemple, v√©rifier l'email)\r\n   * @param {string} oobCode - Le code d'action Firebase\r\n   */\r\n  async applyActionCode(oobCode) {\r\n    try {\r\n      await applyActionCode(auth, oobCode);\r\n      console.log('‚úÖ Action code applied successfully');\r\n      return {\r\n        success: true,\r\n        message: 'Action appliqu√©e avec succ√®s'\r\n      };\r\n    } catch (error) {\r\n      console.error('‚ùå Error applying action code:', error);\r\n      throw error;\r\n    }\r\n  }\r\n};\r\n\r\nexport default firebaseAuthService;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}